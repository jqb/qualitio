<div id="application-view-header">
  <h1>requirement: {{ requirement.name }}</h1>
</div>

<div id="application-view-menu">
  <a href="#requirement/{{ requirement.pk }}/details/">details</a>
  <span class="active">edit</span>
  <a href="#requirement/{{ requirement.pk }}/testcases/">test cases</a>
</div>

<script type="text/javascript"> 
  function showResponse(response, statusText, xhr, $form)  { 
    if(!response.success) {
      $(response.data).each(function(i, element) {
        $("#"+element[0]+"_wrapper").addClass("ui-state-error");
        $("#"+element[0]+"_wrapper .error").append(element[1]);
        $('#notification').jnotifyAddMessage({
          text: response.message,
          permanent: false,
          type: "error"
        });
      });
    } else {
      $('#notification').jnotifyAddMessage({
        text: response.message,
        permanent: false,
        disappearTime: 2000
      });
      hash.node = response.data.current_id; // for new created objects go to details view 
      hash.view = "details" 
      hash.update();
      $('#application-tree').jstree('refresh',-1);
    }
  }

$(document).ready(function() { 
  $('#requirement_form').ajaxForm({ 
    success: showResponse 
  });
}); 
</script> 

<form id="requirement_form" action="/require/ajax/requirement/{{ requirement.id }}/edit/valid/" method="post"> 
  <div class="application-view-content">
    {% csrf_token %}
    {% for field in requirement_form %}
    <div id="{{ field.html_name }}_wrapper" class="field-wrapper">
      {{ field.label_tag }}: <span class="error"></span>
      {{ field }}
    </div>
    {% endfor %}
  </div>

  <div id="application-view-footer" class="grid_16 clearfix">
    <div class="grid_8 left">
      <input type="submit" name="Executed" value="Delete" />
    </div>
    <div class="grid_8 right">
    <input type="submit" name="Executed" value="Save" />
    </div>
  </div>
</form>
